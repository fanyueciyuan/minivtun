# ç¼–è¯‘é—®é¢˜è¯´æ˜å’Œè§£å†³æ–¹æ¡ˆ

## âœ… å·²ä¿®å¤: bool ç±»å‹å†²çª

**é—®é¢˜**: `crypto_wrapper.h` ä¸­çš„ `#include <stdbool.h>` ä¸é¡¹ç›®è‡ªå®šä¹‰çš„ `bool` ç±»å‹å†²çª

**ä¿®å¤**:
- ç§»é™¤ `<stdbool.h>` å¼•ç”¨
- ä½¿ç”¨é¡¹ç›®ç»Ÿä¸€çš„ `typedef char bool` å®šä¹‰
- Commit: 6f0aa8b

---

## âš ï¸ macOS ç¼–è¯‘é—®é¢˜

### é—®é¢˜æè¿°

MiniVTun ä¸»è¦ä¸º **Linux** è®¾è®¡,åœ¨ macOS ä¸Šç¼–è¯‘ä¼šé‡åˆ°å¹³å°å…¼å®¹æ€§é—®é¢˜:

```
library.c:226:20: error: use of undeclared identifier 'SIOGIFINDEX'
library.c:231:13: error: no member named 'ifr_ifindex' in 'struct ifreq'
library.c:306:6: error: no member named 'ifr_qlen' in 'struct ifreq'
library.c:307:20: error: use of undeclared identifier 'SIOCSIFTXQLEN'
```

**åŸå› **: è¿™äº›æ˜¯ Linux ç‰¹æœ‰çš„ç½‘ç»œ ioctl è°ƒç”¨,macOS ä¸æ”¯æŒã€‚

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: åœ¨ Linux ç¯å¢ƒç¼–è¯‘ (æ¨è)

#### A. ä½¿ç”¨è™šæ‹Ÿæœº

```bash
# 1. å®‰è£… VirtualBox æˆ– VMware
# 2. åˆ›å»º Ubuntu/Debian è™šæ‹Ÿæœº
# 3. åœ¨è™šæ‹Ÿæœºä¸­ç¼–è¯‘

# åœ¨ Ubuntu è™šæ‹Ÿæœºä¸­:
git clone https://github.com/fanyueciyuan/minivtun.git
cd minivtun/src
sudo apt-get install build-essential libssl-dev
make clean && make

# ç¼–è¯‘æˆåŠŸ!
```

#### B. ä½¿ç”¨ Docker

```bash
# åœ¨ macOS ä¸Šä½¿ç”¨ Docker ç¼–è¯‘ Linux ç‰ˆæœ¬
docker run --rm -it -v $(pwd):/work ubuntu:22.04 bash

# åœ¨å®¹å™¨å†…:
cd /work
apt-get update
apt-get install -y build-essential libssl-dev git
cd src
make clean && make

# ç¼–è¯‘äº§ç‰©åœ¨å½“å‰ç›®å½•
```

#### C. ä½¿ç”¨äº‘æœåŠ¡å™¨

```bash
# åœ¨ Linux äº‘æœåŠ¡å™¨ä¸Šç¼–è¯‘
ssh user@your-server
git clone https://github.com/fanyueciyuan/minivtun.git
cd minivtun/src
make clean && make
```

---

### æ–¹æ¡ˆ 2: ä¿®å¤ macOS å…¼å®¹æ€§ (éœ€è¦é¢å¤–å¼€å‘)

MiniVTun æœ‰ `platform_bsd.c` æ–‡ä»¶,ä½† `library.c` ä¸­ä»åŒ…å« Linux ç‰¹å®šä»£ç ã€‚

éœ€è¦ä¿®æ”¹çš„å†…å®¹:

1. **library.c** (ä¿®å¤ macOS ä¸æ”¯æŒçš„ ioctl):
   - `SIOGIFINDEX` â†’ macOS æ›¿ä»£æ–¹æ¡ˆ
   - `ifr_ifindex` â†’ ä½¿ç”¨ `if_nametoindex()`
   - `SIOCSIFTXQLEN` â†’ macOS ä¸æ”¯æŒ,éœ€è¦æ¡ä»¶ç¼–è¯‘

2. **Makefile** (æ”¹è¿›å¹³å°æ£€æµ‹):
   ```makefile
   ifeq ($(shell uname -s), Darwin)
       PLATFORM = bsd
       CFLAGS += -D__APPLE__
   endif
   ```

**é¢„è®¡å·¥ä½œé‡**: 2-4 å°æ—¶
**ä¸æ¨è**,å› ä¸º MiniVTun ä¸»è¦ç”¨äº Linux æœåŠ¡å™¨ã€‚

---

### æ–¹æ¡ˆ 3: äº¤å‰ç¼–è¯‘ (ä»…ç”¨äºå¼€å‘)

åœ¨ macOS ä¸Šäº¤å‰ç¼–è¯‘ Linux äºŒè¿›åˆ¶æ–‡ä»¶(éœ€è¦äº¤å‰ç¼–è¯‘å·¥å…·é“¾)ã€‚

**ä¸æ¨è**: å¤æ‚ä¸”æµ‹è¯•å›°éš¾ã€‚

---

## ğŸ“‹ æ¨èæµç¨‹

### å¼€å‘æµç¨‹ (å½“å‰)

1. **åœ¨ macOS ä¸Šå¼€å‘ä»£ç **:
   - ä¿®æ”¹æºæ–‡ä»¶
   - Git æäº¤å’Œæ¨é€
   - æ–‡æ¡£ç¼–å†™

2. **åœ¨ Linux ç¯å¢ƒç¼–è¯‘æµ‹è¯•**:
   - è™šæ‹Ÿæœº/Docker/äº‘æœåŠ¡å™¨
   - æ‹‰å–ä»£ç : `git pull`
   - ç¼–è¯‘: `make clean && make`
   - æµ‹è¯•è¿è¡Œ

3. **å›åˆ° macOS ç»§ç»­å¼€å‘**:
   - æ ¹æ®æµ‹è¯•ç»“æœä¿®æ”¹
   - å¾ªç¯å¾€å¤

---

## ğŸ¯ å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆ

- [x] ä¿®å¤ bool ç±»å‹å†²çª (Commit: 6f0aa8b)
- [x] ä»£ç å·²æ¨é€åˆ° GitHub
- [x] HMAC è®¤è¯ä¿®å¤å®Œæˆ (5ä¸ªæ–‡ä»¶)

### â³ å¾…è§£å†³

- [ ] macOS ç¼–è¯‘é—®é¢˜ (éœ€è¦ Linux ç¯å¢ƒ)

---

## ğŸ” éªŒè¯ç¼–è¯‘ (åœ¨ Linux ä¸Š)

### Ubuntu/Debian

```bash
# 1. å…‹éš†ä»£ç 
git clone https://github.com/fanyueciyuan/minivtun.git
cd minivtun/src

# 2. å®‰è£…ä¾èµ–
sudo apt-get update
sudo apt-get install -y build-essential libssl-dev libmbedtls-dev

# 3. ç¼–è¯‘ OpenSSL ç‰ˆæœ¬
make clean && make

# 4. éªŒè¯
./minivtun -h

# é¢„æœŸè¾“å‡º: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

### CentOS/RHEL

```bash
# 1. å®‰è£…ä¾èµ–
sudo yum install -y gcc make openssl-devel mbedtls-devel

# 2. ç¼–è¯‘
cd minivtun/src
make clean && make

# 3. éªŒè¯
./minivtun -h
```

---

## ğŸ³ Docker å¿«é€ŸéªŒè¯

åˆ›å»º `Dockerfile`:

```dockerfile
FROM ubuntu:22.04

RUN apt-get update && \
    apt-get install -y build-essential libssl-dev git && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /build

RUN git clone https://github.com/fanyueciyuan/minivtun.git && \
    cd minivtun/src && \
    make clean && make

CMD ["/build/minivtun/src/minivtun", "-h"]
```

ç¼–è¯‘å’Œè¿è¡Œ:

```bash
# åœ¨ macOS ä¸Šæ„å»º Docker é•œåƒ
docker build -t minivtun-build .

# è¿è¡ŒéªŒè¯
docker run --rm minivtun-build

# æå–ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶
docker run --rm -v $(pwd):/out minivtun-build \
  cp /build/minivtun/src/minivtun /out/
```

---

## ğŸ“ æ€»ç»“

### å½“å‰æœ€ä½³å®è·µ

1. **ä»£ç å¼€å‘**: macOS (ä½ çš„ä¸»è¦ç¯å¢ƒ)
2. **ç¼–è¯‘æµ‹è¯•**: Linux è™šæ‹Ÿæœº/Docker/äº‘æœåŠ¡å™¨
3. **ç”Ÿäº§éƒ¨ç½²**: Linux æœåŠ¡å™¨

### Git å·¥ä½œæµ

```bash
# macOS ä¸Šå¼€å‘
vim src/some_file.c
git add src/some_file.c
git commit -m "Update feature"
git push origin master

# Linux ç¯å¢ƒç¼–è¯‘
git pull origin master
make clean && make
./minivtun -h  # æµ‹è¯•

# å¦‚æœæœ‰é—®é¢˜,å›åˆ° macOS ä¿®æ”¹
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¿…é¡»åœ¨ Linux ä¸Šç¼–è¯‘å—?

**A**: æ˜¯çš„,MiniVTun ä½¿ç”¨äº† Linux ç‰¹æœ‰çš„ç½‘ç»œ APIã€‚è™½ç„¶æœ‰ `platform_bsd.c`,ä½†æ ¸å¿ƒä»£ç ä»ä¾èµ– Linuxã€‚

### Q2: èƒ½å¦ä¿®å¤è®©å®ƒåœ¨ macOS ä¸Šç¼–è¯‘?

**A**: ç†è®ºä¸Šå¯ä»¥,ä½†éœ€è¦:
- ä¿®æ”¹ `library.c` çš„ç½‘ç»œç›¸å…³ä»£ç 
- æ·»åŠ  macOS ç‰¹å®šçš„å®ç°
- é¢„è®¡å·¥ä½œé‡ 2-4 å°æ—¶
- ä¸æ¨è,å› ä¸º MiniVTun æ˜¯ç”¨äº Linux æœåŠ¡å™¨çš„ VPN å·¥å…·

### Q3: å¦‚ä½•å¿«é€Ÿæµ‹è¯•ç¼–è¯‘?

**A**: ä½¿ç”¨ Docker (æœ€å¿«):
```bash
docker run --rm -v $(pwd):/work -w /work/src ubuntu:22.04 bash -c \
  "apt-get update && apt-get install -y build-essential libssl-dev && make clean && make"
```

### Q4: æˆ‘åº”è¯¥ç»§ç»­åœ¨ macOS ä¸Šå¼€å‘å—?

**A**: å¯ä»¥!
- macOS: ä»£ç ç¼–è¾‘ã€Git ç®¡ç†ã€æ–‡æ¡£ç¼–å†™
- Linux: ç¼–è¯‘ã€æµ‹è¯•ã€è¿è¡Œ
- è¿™æ˜¯å¾ˆå¸¸è§çš„è·¨å¹³å°å¼€å‘æ¨¡å¼

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³è¡ŒåŠ¨

1. âœ… åœ¨ Linux ç¯å¢ƒéªŒè¯ç¼–è¯‘ (è™šæ‹Ÿæœº/Docker/äº‘æœåŠ¡å™¨)
2. âœ… æµ‹è¯• HMAC ä¿®å¤åŠŸèƒ½
3. âœ… å¦‚éœ€ç»§ç»­å¼€å‘,ä¿æŒ macOS (ä»£ç ) + Linux (ç¼–è¯‘) æ¨¡å¼

### å¯é€‰ä¼˜åŒ– (é•¿æœŸ)

- [ ] é…ç½®è‡ªåŠ¨åŒ– CI/CD (GitHub Actions)
- [ ] æ¯æ¬¡æ¨é€è‡ªåŠ¨åœ¨ Linux ç¯å¢ƒç¼–è¯‘
- [ ] è‡ªåŠ¨è¿è¡Œæµ‹è¯•

---

**å½“å‰çŠ¶æ€**: ä»£ç å®Œæˆ,éœ€è¦åœ¨ Linux ç¯å¢ƒç¼–è¯‘æµ‹è¯•
**Git Commit**: 6f0aa8b (bool ç±»å‹ä¿®å¤)
**æ¨è**: ä½¿ç”¨ Docker æˆ–è™šæ‹Ÿæœºç¼–è¯‘

ğŸ”§ **å‡†å¤‡å¥½ååœ¨ Linux ç¯å¢ƒæ‰§è¡Œ `make clean && make` å³å¯!**
